<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/3d-piano/manifest.json"><link rel="shortcut icon" href="/3d-piano/favicon.ico"><script src="/3d-piano/vendors/three.js"></script><script src="/3d-piano/vendors/OrbitAndPanControls.js"></script><script src="/3d-piano/vendors/ColladaLoader.js"></script><script src="/3d-piano/vendors/base64binary.js" type="text/javascript"></script><script src="/3d-piano/vendors/MIDI/AudioDetect.js" type="text/javascript"></script><script src="/3d-piano/vendors/MIDI/LoadPlugin.js" type="text/javascript"></script><script src="/3d-piano/vendors/MIDI/Plugin.js" type="text/javascript"></script><script src="/3d-piano/vendors/MIDI/Player.js" type="text/javascript"></script><script src="/3d-piano/vendors/MIDI/Loader.js" type="text/javascript"></script><script src="/3d-piano/vendors/Window/DOMLoader.script.js" type="text/javascript"></script><script src="/3d-piano/vendors/jasmid/stream.js"></script><script src="/3d-piano/vendors/jasmid/midifile.js"></script><script src="/3d-piano/vendors/jasmid/replayer.js"></script><script type="text/javascript" src="/3d-piano/vendors/dat.gui.js"></script><title>3d-piano</title><link href="/3d-piano/static/css/main.9a0fe4f1.css" rel="stylesheet"></head><body><script type="text/javascript">function smoothstep(e,o,t){if(t<e)return 0;if(t>o)return 1;var a=(t-e)/(o-e);return a*a*(3-2*a)}function mix(e,o,t){return e+(o-e)*Math.min(Math.max(t,0),1)}function on_window_resize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function init_lights(){var e=new THREE.DirectionalLight(16777215);e.position.set(1,2.4,-7.5),e.target.position.set(6,-6,7),e.shadowCameraVisible=!1,e.shadowDarkness=.75,e.intensity=1,e.castShadow=!0,e.shadowMapWidth=2048,e.shadowMapHeight=2048,e.shadowCameraNear=5,e.shadowCameraFar=20,e.shadowBias=.0025,e.shadowCameraLeft=-8.85,e.shadowCameraRight=5.5,e.shadowCameraTop=4,e.shadowCameraBottom=0,scene.add(e);var o=new THREE.DirectionalLight(14548991,.5);o.position.set(1,1,1).normalize(),scene.add(o),(o=new THREE.DirectionalLight(16733525,.5)).position.set(-1,-1,-1).normalize(),scene.add(o)}function prepare_scene(e){e.scene.traverse(initialize_keys),scene.add(e.scene)}function initialize_keys(e){keys_obj.push(e),e.rotation.x=-Math.PI/4,e.rotation.y=0,e.rotation.z=0,e.keyState=keyState.unpressed,e.clock=new THREE.Clock(!1),e.castShadow=!0,e.receiveShadow=!0,e instanceof THREE.Mesh&&(old_material=e.material,e.material=new THREE.MeshPhongMaterial({color:old_material.color}),e.material.shininess=35,e.material.specular=(new THREE.Color).setRGB(.25,.25,.25),e.material.note_off=e.material.color.clone())}function key_status(e,o){var t=scene.getObjectByName(e,!0);void 0!=t&&(t.clock.start(),t.clock.elapsedTime=0,t.keyState=o)}function frame(){requestAnimationFrame(frame);var e=clock.getDelta();update(e),render(e)}function update_key(e,o){e.keyState==keyState.note_on?(e.rotation.x=mix(-Math.PI/4,-controls.key_max_rotation,smoothstep(0,1,controls.key_attack_time*e.clock.getElapsedTime())),e.rotation.x>=-controls.key_max_rotation&&(e.keyState=keyState.pressed,e.clock.elapsedTime=0),e.material.color=noteOnColor):e.keyState==keyState.note_off&&(e.rotation.x=mix(-controls.key_max_rotation,-Math.PI/4,smoothstep(0,1,controls.key_attack_time*e.clock.getElapsedTime())),e.rotation.x<=-Math.PI/4&&(e.keyState=keyState.unpressed,e.clock.elapsedTime=0),e.material.color=e.material.note_off)}function update(e){cameraControls.update(e);for(i in keys_obj)update_key(keys_obj[i],e)}function render(e){renderer.render(scene,camera)}function keyCode_to_note(e){var o=-1;return 90==e&&(o=0),83==e&&(o=1),88==e&&(o=2),68==e&&(o=3),67==e&&(o=4),86==e&&(o=5),71==e&&(o=6),66==e&&(o=7),72==e&&(o=8),78==e&&(o=9),74==e&&(o=10),77==e&&(o=11),188==e&&(o=12),81==e&&(o=12),50==e&&(o=13),87==e&&(o=14),51==e&&(o=15),69==e&&(o=16),82==e&&(o=17),53==e&&(o=18),84==e&&(o=19),54==e&&(o=20),89==e&&(o=21),55==e&&(o=22),85==e&&(o=23),73==e&&(o=24),57==e&&(o=25),79==e&&(o=26),48==e&&(o=27),80==e&&(o=28),219==e&&(o=29),187==e&&(o=30),221==e&&(o=31),-1==o?-1:"_"+(o+12*controls.octave)}MIDI.loader=new widgets.Loader({message:"Loading: Soundfont..."});var controls=new function(){this.key_attack_time=9,this.key_max_rotation=.72,this.octave=2,this.song="game_of_thrones.mid",this.noteOnColor=[255,0,0,1],this.play=function(){MIDI.Player.resume()},this.stop=function(){MIDI.Player.stop()}},keyState=Object.freeze({unpressed:{},note_on:{},pressed:{},note_off:{}}),scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(30,window.innerWidth/window.innerHeight,2,5e3),keys_down=[],keys_obj=[],renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMapEnabled=!0,renderer.shadowMapSoft=!0,renderer.shadowMapType=THREE.PCFSoftShadowMap,renderer.gammaInput=!0,renderer.gammaOutput=!0,renderer.physicallyBasedShading=!0,document.body.appendChild(renderer.domElement);var material=new THREE.MeshLambertMaterial({color:6316128});floor=new THREE.Mesh(new THREE.PlaneGeometry(8e3,8e3),new THREE.MeshBasicMaterial({color:15790320})),floor.rotation.x=Math.PI/180*-90,floor.position.y=-.45,floor.receiveShadow=!0,floor.castShadow=!0,scene.add(floor),scene.fog=new THREE.Fog(16777215,40,50),noteOnColor=(new THREE.Color).setRGB(controls.noteOnColor[0]/256,controls.noteOnColor[1]/256,controls.noteOnColor[2]/256),init_lights();var loader=new THREE.ColladaLoader;loader.load("piano.dae",prepare_scene),camera.position.x=-2.77,camera.position.z=10.04,camera.position.y=5.51;var cameraControls=new THREE.OrbitAndPanControls(camera,renderer.domElement);cameraControls.target.set(4.5,0,0);var clock=new THREE.Clock;frame(),window.onkeydown=function(e){if(1!=keys_down[e.keyCode]&&-1!=(o=keyCode_to_note(e.keyCode))){key_status(o,keyState.note_on),keys_down[e.keyCode]=!0;var o=parseInt(o.substr(1))+21;MIDI.setVolume(0,127),MIDI.noteOn(0,o,127,0)}},window.onkeyup=function(e){if(1==keys_down[e.keyCode]){key_status(o=keyCode_to_note(e.keyCode),keyState.note_off),keys_down[e.keyCode]=!1;var o=parseInt(o.substr(1))+21;MIDI.setVolume(0,127),MIDI.noteOff(0,o,.08)}},window.onload=function(){MIDI.loadPlugin(function(){MIDI.Player.timeWarp=1,MIDI.Player.loadFile("midi/"+controls.song),MIDI.Player.addListener(function(e){var o=e.note-MIDI.pianoKeyOffset-3;144===e.message?key_status("_"+o,keyState.note_on):key_status("_"+o,keyState.note_off)}),MIDI.loader.stop(),songsToFiles={"Game Of Thrones Theme, Ramin Djawadi":"game_of_thrones.mid","Mario Overworld Theme (Super Mario Bros 3), Koji Kondo":"mario_-_overworld_theme.mid","He's a Pirate (Pirates of the Caribbean), Klaus Badelt":"hes_a_pirate.mid","Hedwigs Theme (Harry Potter), John Williams":"hedwigs_theme.mid","Something There (Beauty and the Beast), Alan Menken":"something_there.mid","Cruel Angel Thesis (Neon Genesis Evangelion)":"cruel_angel__s_thesis.mid","Me cuesta tanto olvidarte (Mecano)":"me_cuesta.mid","Sonata No. 14 C# minor (Moonlight), Beethoven":"mond_1.mid","For Elise, Beethoven":"for_elise_by_beethoven.mid","Asturias (Leyenda), Albeniz":"alb_se5_format0.mid","Aragon (Fantasia), Albeniz":"alb_se6.mid","Prelude and Fugue in C major BWV 846, Bach":"bach_846.mid","Fantasia C major, Schubert":"schub_d760_1.mid","Sonata No. 16 C major, Mozart":"mz_545_1.mid","Sonata No. 11 A major (K331, First Movement), Mozart":"mz_331_1.mid","March - Song of the Lark, Tchaikovsky":"ty_maerz.mid","Piano Sonata in C major, Hoboken, Haydn":"haydn_35_1.mid","Etudes, Opus 25, Chopin":"chpn_op25_e1.mid","Polonaise Ab major, Opus 53, Chopin":"chpn_op53.mid","No. 2 - Oriental, Granados":"gra_esp_2.mid","Bohemian Rhapsody, Queen":"bohemian1.mid"};var e=new dat.GUI({width:625}),o=e.add(controls,"song",songsToFiles);e.addColor(controls,"noteOnColor").onChange(function(e){noteOnColor=(new THREE.Color).setRGB(controls.noteOnColor[0]/256,controls.noteOnColor[1]/256,controls.noteOnColor[2]/256)}),o.onChange(function(e){MIDI.Player.stop(),MIDI.Player.loadFile("midi/"+e,MIDI.Player.start)}),e.add(controls,"octave",0,4).step(1).onChange(function(e){for(keyCode in keys_down)key_status(keyCode_to_note(keyCode),keyState.note_off)}),e.add(controls,"play"),e.add(controls,"stop")})},window.addEventListener("resize",on_window_resize,!1)</script><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">_uacct="UA-302418-4",urchinTracker()</script><script type="text/javascript">var gaJsHost="https:"==document.location.protocol?"https://ssl.":"http://www.";document.write(unescape("%3Cscript src='"+gaJsHost+"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"))</script><script type="text/javascript">try{var pageTracker=_gat._getTracker("UA-302418-4");pageTracker._trackPageview()}catch(a){}</script><div id="root"></div><script type="text/javascript" src="/3d-piano/static/js/main.f597a4f4.js"></script></body></html>